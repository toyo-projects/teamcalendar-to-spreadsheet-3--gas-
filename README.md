# Googleカレンダー集計スクリプト（Google Apps Script）

📅 スプレッドシート上から複数ユーザーのGoogleカレンダー予定を集計し、指定フォーマットで出力するGASスクリプトです。

---

## 🛠 機能概要

- Googleスプレッドシート「設定」シートから対象ユーザーと期間を取得
- 各ユーザーのGoogleカレンダー予定を取得（集計対象フラグ付き）
- 実行日ベースでシート名（例：`20250422_1`）を生成して出力
- 出力項目：名前、日付、時間帯、タイトル、工数（時間）
- ダイアログ＋トースト通知で操作フィードバックあり

---

## 📂 構成シート

### 「設定」シート

| メールアドレス              | 日付（FROM） | 日付（TO）   | 集計対象 | 実行日（任意） |
|----------------------------|---------------|---------------|------------|------------------|
| sample.user@example.com    | 2025/04/21     | 2025/04/22     | 0          |                  |

- `集計対象` = 0 のみが処理対象
- `実行日` は運用上の記録欄として任意

---

## 🧾 出力イメージ（自動作成シート）

| 名前     | 日付        | 時間帯         | タイトル             | 工数     |
|----------|-------------|----------------|----------------------|----------|
| 山田太郎 | 2025/04/21 | 10:00〜11:00   | 定例ミーティング       | 1.0h     |

- 実行ごとに `yyyyMMdd_1`, `yyyyMMdd_2` ... の形式で新しいシートが生成されます

---
## 🚀 実行方法①
1. Googleスプレッドシートを作成
2. `拡張機能 > Apps Script` でコードを貼り付け
3. スクリプトを保存し、`importGroupCalendarEventsWithNames()` を実行
4. 初回実行時に**Googleカレンダーの権限許可**を求められるので承認

---

## 🚀 実行方法②(ボタンの設置方法)

1. スプレッドシート上に「図形ボタン（例：🔁 集計開始）」を作成
2. ボタン上で右クリック後、右上にある三点マーク（︙）を押下し、スクリプトの割り当てを押下する。
3. GAS関数 `collectCalendarEvents` をスクリプトに記述
4. ボタンに `collectCalendarEvents` を割り当て
5. ボタンを押すと、対象カレンダーの予定を抽出して新シートに出力！

> 🔐 各ユーザーのGoogleカレンダーは、スクリプト実行者に「予定の詳細を表示」権限で共有されている必要があります。

---

## 📜 使用技術

- Google Apps Script（GAS）
- Google Calendar API（標準組み込み）
- Google Spreadsheet UI API（toast, alert）

---

## 💬 備考

- 15分単位で工数を切り下げ
- ダイアログ通知＆右下のトースト通知つき
- 処理中にエラーが出たユーザーはログで確認可能（`Logger.log()`）

---


